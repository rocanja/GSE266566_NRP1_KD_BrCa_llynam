---
title: "Figure.1 SDATA-24-03470"
subtitle: "GSE266566.overview.diagram"
---

```{r include=FALSE}

library(ggplot2)
library(dplyr)
#
level.order.treat<-c("siNT","siNRP1.3","siNRP1.5","shNT","shNRP1.3","shNRP1.5") 
group.colors.treat<-colorspace::desaturate(c("darkorange","#E41A1C","purple","black","#0000FF","green"),amount=0.15) #muted colors
scales::show_col(group.colors.treat)

```


```{r}

## Create data frame for rectangles
n_rows <- 6
n_cols <- 3
total_rects <- n_rows * n_cols
#
## Base size of rectangles
rect_width <- 3
rect_height <- 0.7
#
## labels
rect_labels<-rep(c('shNRP1 #5 (x3)','shNRP1 #3 (x3)','shNT (x3)','siNRP1 #5 (x3)','siNRP1 #3 (x3)','siNT (x3)'), times=3)
#
## Define blocks for labeling on left side (blocks of 3 rows)
df <- expand.grid(row = 1:n_rows, col = 1:n_cols) %>%
  arrange(col, row) %>%
  mutate(
    x = (col - 1) * (rect_width + 0.5), #horizontal spacing
    y = ifelse(row <= 3, row - 1, row - 1 + 0.5), 
    xmin = x,
    xmax = x + rect_width,
    ymin = rep(c(0,0.85,1.7, 3,3.85,4.7),3), #instead of y, manual definition worked best 
    ymax = ymin + rect_height,
    label = rect_labels,
    row_color = factor(row)  # Different color by row
  )
df
### 2 outlier samples removed: HS578T.shNRP1.3.3 and SUM159.siNRP1.5.1
df[14,'label']<-'shNRP1 #3 (x2)'
df[4,'label']<-'siNRP1 #5 (x2)'  
df
#
## Define left side block labels for every 3 rows
block_labels <- data.frame(
  block = c("NRP1.shRNA\n48 hrs\nafter seeding", "NRP1.siRNA\n72 hrs\npost transfection"),
  x = -0.3,             # Placed left outside rectangles
  y = c(1.2,4.2) #manual works better
)
block_labels
#
## Column headers
headers <- data.frame(
  col = 1:n_cols,
  x = (0:(n_cols - 1)) * (rect_width + 0.5) + rect_width / 2,
  #y = max(df$y) + rect_height * 1.5,
  y = max(df$ymax) + 0.35,
  header = c("SUM159PT", "MDA-MB-231", "HS578T")
)
#
## Define a color palette for rows
row_colors <- rev(group.colors.treat)
#
## combine plot
plot<-ggplot() +
  geom_rect(data = df, aes(xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax, color = row_color, fill = row_color), linewidth=1.5) +
  geom_text(data = df, aes(x = xmin + rect_width/2, y = ymin + rect_height/2, label = label), size = 5, fontface = "bold") +
  geom_text(data = headers, aes(x = x, y = y, label = header), size = 6, fontface = "bold") +
  geom_text(data = block_labels, aes(x = x, y = y, label = block), size = 5, hjust = 1, fontface = "italic") +
  annotate(geom='text', x=-1.3, y=2.7, label='strand.specific\nmRNAseq\nPE.150bp', size = 5, hjust = 0.5, color='grey60')+
  scale_color_manual(values = row_colors) +
  scale_fill_manual(values = alpha(row_colors,0.2)) +
  theme_void() +
  theme(legend.position='none')+
  expand_limits(x = -2, y = max(headers$y))
plot

```

```{r}

### A4 page in inches: 8.3 x 11.7 inches --> width=15,height=21.14
dev.new(width=10, height=5, noRStudioGD = T, rescale='fixed')
#
plot
#
cowplot::save_plot("Figure1.pdf", plot = plot, base_width = 10, base_height = 5)

```


<br>

***  

# R.session Info


```{r Rsession, echo=FALSE}

sessionInfo() #record the R and package versions used
#############################
#RStudio.Version()
# RStudio 2024.12.1+563 "Kousa Dogwood" Release (27771613951643d8987af2b2fb0c752081a3a853, 2025-02-02) for windows
# Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) RStudio/2024.12.1+563 Chrome/126.0.6478.234 Electron/31.7.7 Safari/537.36, Quarto 1.5.57
##############################
# R version 4.4.3 (2025-02-28 ucrt)
# Platform: x86_64-w64-mingw32/x64
# Running under: Windows 11 x64 (build 22631)
# 
# Matrix products: default
# 
# 
# locale:
# [1] LC_COLLATE=English_Australia.utf8  LC_CTYPE=English_Australia.utf8   
# [3] LC_MONETARY=English_Australia.utf8 LC_NUMERIC=C                      
# [5] LC_TIME=English_Australia.utf8    
# 
# time zone: Australia/Brisbane
# tzcode source: internal
# 
# attached base packages:
# [1] stats     graphics  grDevices utils     datasets  methods   base     
# 
# other attached packages:
# [1] dplyr_1.1.4   ggplot2_4.0.0
# 
# loaded via a namespace (and not attached):
#  [1] vctrs_0.6.5        cli_3.6.5          knitr_1.50         rlang_1.1.6        xfun_0.53         
#  [6] generics_0.1.4     S7_0.2.0           glue_1.8.0         colorspace_2.1-1   htmltools_0.5.8.1 
# [11] rsconnect_1.5.1    scales_1.4.0       rmarkdown_2.29     grid_4.4.3         evaluate_1.0.5    
# [16] tibble_3.3.0       fastmap_1.2.0      yaml_2.3.10        lifecycle_1.0.4    compiler_4.4.3    
# [21] RColorBrewer_1.1-3 pkgconfig_2.0.3    rstudioapi_0.17.1  farver_2.1.2       digest_0.6.37     
# [26] R6_2.6.1           tidyselect_1.2.1   pillar_1.11.0      magrittr_2.0.4     withr_3.0.2       
# [31] tools_4.4.3        gtable_0.3.6   
##############################

```

***